<!DOCTYPE html>
<html lang="en">
<head> 
    google.com, pub-8643297009175061, DIRECT, f08c47fec0942fa0
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NRC58MM5');</script>
<!-- End Google Tag Manager -->
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QDJTCTE8YJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QDJTCTE8YJ');
</script> 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8643297009175061"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="google-adsense-account" content="ca-pub-8643297009175061">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="discription" content="This is qr code maker website, where you can generate qr codes for free">
    <meta name="discription" content="This is link shortner website, where you can generate short links for free">
    <meta name="keywords" content="Free QR Code Generator & URL Shortener | Fast Online Utility Tool">
    <meta name="keywords" content="QR Code Generator Online - Free Tool">
    <meta name="keywords" content="Free QR Code Maker and Creator">
    <meta name="keywords" content="Best Online QR Code Generator Tool">
<meta name="keywords" content="Generate QR Codes Instantly & Free">
<meta name="keywords" content="QR Code Generator for All Data Types">
<meta name="keywords" content="Professional QR Code Generator">
<meta name="keywords" content="The Ultimate Free QR Code Generator">
<meta name="keywords" content="High-Quality QR Code Maker Online">
<meta name="keywords" content="QR Code Generator - No Sign Up Required">
<meta name="keywords" content="Quick & Easy QR Code Creator">
<meta name="keywords" content="Secure QR Code Generator Tool">
<meta name="keywords" content="Official QR Code Generator Service">
<meta name="keywords" content="Free and Fast QR Code Generator">
<meta name="keywords" content="QR Code Generation Website">
<meta name="keywords" content="Modern QR Code Maker for 2024">
<meta name="keywords" content="Simple Online QR Code Tool">
<meta name="keywords" content="Create and Download QR Codes Free">
<meta name="keywords" content="Your Go-To QR Code Generator">
<meta name="keywords" content="Online QR Code Service for Business">
<meta name="keywords" content="Free QR Code Generator">
<meta name="keywords" content="Custom QR Code Generator with Logo">
<meta name="keywords" content="QR Code Generator: Custom Colors & Shapes">
<meta name="keywords" content="Design Your Own QR Code with Logo Embed">
<meta name="keywords" content="Branded QR Code Generator - Free Customization">
<meta name="keywords" content="QR Code Style Customization Tool">
<meta name="keywords" content="Personalized QR Code Generator">
<meta name="keywords" content="QR Code Maker with Image/Logo Integration">
<meta name="keywords" content="Free Custom Design QR Code Generator">
<meta name="keywords" content="Create a Branded QR Code Online">
<meta name="keywords" content="Customizable QR Code Creator">
<meta name="keywords" content="High-Design QR Code Generator">
<meta name="keywords" content="QR Code Maker with Transparent Background">
<meta name="keywords" content="Vector QR Code Generator (SVG/EPS)">
<meta name="keywords" content="Creative QR Code Generator Tool">
<meta name="keywords" content="Logo QR Code Generator Free">
<meta name="keywords" content="Color QR Code Generator Online">
<meta name="keywords" content="Pixel Art QR Code Generator">
<meta name="keywords" content="Professional Custom QR Code Design">
<meta name="keywords" content="QR Code Maker: Add Your Branding">
<meta name="keywords" content="Customizable QR Code Generator">
<meta name="keywords" content="V-Card QR Code Generator | Business Card Codes">
<meta name="keywords" content="WiFi QR Code Generator - Connect Instantly">
<meta name="keywords" content="URL QR Code Generator | Link Encoder">
<meta name="keywords" content="Location QR Code Generator (Google Maps)">
<meta name="keywords" content="SMS & Email QR Code Generator Free">
<meta name="keywords" content="QR Code Generator for Social Media Links">
<meta name="keywords" content="Event QR Code Generator (Calendar/RSVP)">
<meta name="keywords" content="QR Code Generator for Files and Documents">
<meta name="keywords" content="Coupon & Voucher QR Code Generator">
<meta name="keywords" content="QR Code for Payment Link / PayPal">
<meta name="keywords" content="Text QR Code Generator Online">
<meta name="keywords" content="Multi-Link QR Code Generator">
<meta name="keywords" content="App Store Link QR Code Generator">
<meta name="keywords" content="Password & Login QR Code Creator">
<meta name="keywords" content="Contactless Menu QR Code Generator">
<meta name="keywords" content="YouTube Video QR Code Generator">
<meta name="keywords" content="PDF Download QR Code Generator">
<meta name="keywords" content="V-Card Business QR Code Maker">
<meta name="keywords" content="QR Code Generator for Instagram/TikTok">
<meta name="keywords" content="Survey & Feedback QR Code Generator">
<meta name="keywords" content="Instant QR Code Generation Tool">
<meta name="keywords" content="Fastest QR Code Generator Online">
<meta name="keywords" content="Download QR Codes in PNG, JPG, SVG">
<meta name="keywords" content="High Resolution Printable QR Codes">
<meta name="keywords" content="Batch QR Code Generator Tool">
<meta name="keywords" content="API QR Code Generator Free">
<meta name="keywords" content="Rapid QR Code Creator & Downloader">
<meta name="keywords" content="1-Click QR Code Generator">
<meta name="keywords" content="Efficient QR Code Generation Service">
<meta name="keywords" content="Printable QR Code Generator">
<meta name="keywords" content="Best Resolution QR Code Generator">
<meta name="keywords" content="Simple QR Code Encoder and Downloader">
<meta name="keywords" content="Vector-Based QR Code Generator">
<meta name="keywords" content="Fastest Way to Create QR Codes">
<meta name="keywords" content="Zero Latency QR Code Generator">
<meta name="keywords" content="QR Code Generator">
<meta name="keywords" content="QR Code Maker">
<meta name="keywords" content="QR Code Creator">
<meta name="keywords" content="QR Generator">
<meta name="keywords" content="QR Code Tool">
<meta name="keywords" content="Generate QR">
<meta name="keywords" content="QR Creator Free">
<meta name="keywords" content="Make QR Code">
<meta name="keywords" content="Create QR Codes">
<meta name="keywords" content="QR Code Designer">
<meta name="keywords" content="Online QR Maker">
<meta name="keywords" content="QR Code Builder">
<meta name="keywords" content="Instant QR">
<meta name="keywords" content="QR Codes Now">
<meta name="keywords" content="QR Code Design">
<meta name="keywords" content="How to Create a QR Code for Free Online">
<meta name="keywords" content="Free Online Tool to Generate a V-Card QR Code">
<meta name="keywords" content="QR Code Generator with Logo for Small Business">
<meta name="keywords" content="Best Website to Make Custom Color QR Codes">
<meta name="keywords" content="High-Resolution QR Code Download PNG and SVG">
<meta name="keywords" content="Quickly Generate a WiFi Login QR Code">
<meta name="keywords" content="Secure Way to Generate QR Codes for Free">
<meta name="keywords" content="Create a QR Code That Never Expires (Static)">
<meta name="keywords" content="Online QR Code Generator for Printing and Marketing">
<meta name="keywords" content="The Easiest QR Code Generator for Beginners">
<meta name="keywords" content="Where to Make Free Custom QR Codes">
<meta name="keywords" content="Ultimate Guide and Free QR Code Generator Tool">
<meta name="keywords" content="QR Code Creator for Events and Registration Links">
<meta name="keywords" content="Simple QR Code Maker for Personal Use">
<meta name="keywords" content="Fastest Online Tool to Create Any QR Code">
<meta name="keywords" content="Free QR Code Generator for Phone Number & Text">
   <meta name="keywords" content="Download Your QR Code Instantly and Free">
   <meta name="keywords" content="QR Code Generator for Website URL and Links">
   <meta name="keywords" content="Best Free Platform to Design Custom QR Codes">
   <meta name="keywords" content="Quickly Generate Static QR Codes Online">
    <title>Free QR Code Generator & URL Shortener | Fast Online Utility Tool</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for modern aesthetics */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .container-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); /* Stronger shadow */
        }
        .tab-button.active {
            background-color: #4f46e5; /* Indigo-600 */
            color: white;
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.4); /* Stronger active shadow */
            transform: translateY(-2px);
        }
        .tab-button {
            transition: all 0.2s ease-in-out;
        }
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 1.25rem;
            height: 1.25rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #qr-canvas {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        /* Style for interactive buttons */
        button:not(.tab-button) {
            transition: background-color 0.2s, box-shadow 0.2s, transform 0.1s;
        }
        button:hover:not(.tab-button) {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        button:active:not(.tab-button) {
            transform: translateY(1px);
        }
    </style>
    <!-- QR Code Generator Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
</head>
<body class="min-h-screen p-4 md:p-8"> 
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NRC58MM5"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">CodeFlow Utility <span class="text-indigo-600">üõ†Ô∏è</span></h1>
            <p class="text-gray-600">Generate QR Codes and Shorten URLs.</p>
        </header>

        <!-- Tool Selection Tabs (Only two remaining) -->
        <div class="container-card mb-8">
            <nav class="flex flex-wrap justify-center gap-2 md:gap-4 border-b pb-4">
                <button data-tab="generator" class="tab-button bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition hover:bg-indigo-700 shadow-md">
                    üìù QR Generator
                </button>
                <button data-tab="shortener" class="tab-button bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-semibold transition hover:bg-gray-200">
                    üîó URL Shortener
                </button>
            </nav>

            <div id="content-container" class="mt-6">
                <!-- Content will be injected here -->
            </div>
        </div>

        <!-- Notification/Result Modal (Replaces alert/confirm) -->
        <div id="modal-container" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 hidden justify-center items-center p-4">
            <div id="modal-content" class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95 opacity-0">
                <h3 id="modal-title" class="text-xl font-bold mb-3 text-indigo-700"></h3>
                <p id="modal-body" class="text-gray-600 break-words"></p>
                <div class="flex justify-end space-x-2 mt-4">
                    <button id="modal-action-button" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition hidden">Action</button>
                    <button onclick="hideModal()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition">Close</button>
                </div>
            </div>
        </div>

        <!-- Global Status Message (for short-term feedback/loading) -->
        <div id="global-status" class="fixed bottom-4 right-4 bg-yellow-100 text-yellow-800 p-3 rounded-lg shadow-xl opacity-0 hidden transition-opacity duration-300"></div>

    </div>

    <!-- Hidden Firebase/Auth Setup for Environment Compliance -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db, auth;

        if (Object.keys(firebaseConfig).length > 0) {
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                setLogLevel('error');
                auth = getAuth(app);
                
                // Authenticate
                if (initialAuthToken) {
                    signInWithCustomToken(auth, initialAuthToken)
                        .then(() => console.log("Firebase authenticated with custom token."))
                        .catch(error => console.error("Firebase Custom Token Auth Error:", error));
                } else {
                    signInAnonymously(auth)
                        .then(() => console.log("Firebase authenticated anonymously."))
                        .catch(error => console.error("Firebase Anonymous Auth Error:", error));
                }
            } catch (e) {
                console.error("Firebase Initialization Error:", e);
            }
        } else {
            console.log("Firebase configuration not found. Running application without persistence.");
        }
    </script>
    
    <script>
        // --- Global Configuration and State ---
        const apiKey = ""; // API key is handled by the environment
        const apiUrlBase = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        let currentTab = 'generator';


        // --- UI Utility Functions (Modal and Status) ---

        function showModal(title, message, actionText = null, actionCallback = null) {
            const container = document.getElementById('modal-container');
            const content = document.getElementById('modal-content');
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').textContent = message;
            const actionBtn = document.getElementById('modal-action-button');

            if (actionText && actionCallback) {
                actionBtn.textContent = actionText;
                actionBtn.onclick = () => { actionCallback(); hideModal(); };
                actionBtn.classList.remove('hidden');
            } else {
                actionBtn.classList.add('hidden');
            }

            container.classList.remove('hidden');
            container.classList.add('flex');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function hideModal() {
            const container = document.getElementById('modal-container');
            const content = document.getElementById('modal-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                container.classList.add('hidden');
            }, 300);
        }

        function showGlobalStatus(message, duration = 3000, isError = false) {
            const statusEl = document.getElementById('global-status');
            statusEl.textContent = message;
            statusEl.className = `fixed bottom-4 right-4 p-3 rounded-lg shadow-xl transition-opacity duration-300 ${isError ? 'bg-red-100 text-red-800' : 'bg-yellow-100 text-yellow-800'}`;
            statusEl.classList.remove('hidden', 'opacity-0');
            statusEl.classList.add('opacity-100');

            if (duration > 0) {
                setTimeout(() => {
                    statusEl.classList.remove('opacity-100');
                    statusEl.classList.add('opacity-0');
                    setTimeout(() => statusEl.classList.add('hidden'), 300);
                }, duration);
            }
        }

        function hideGlobalStatus() {
            const statusEl = document.getElementById('global-status');
            statusEl.classList.remove('opacity-100');
            statusEl.classList.add('opacity-0');
            setTimeout(() => statusEl.classList.add('hidden'), 300);
        }


        function copyToClipboard(elementId) {
            const input = document.getElementById(elementId);
            if (!input) return;

            try {
                // For input/textarea, select the content
                if (input.tagName === 'INPUT' || input.tagName === 'TEXTAREA') {
                    input.select();
                    input.setSelectionRange(0, 99999);
                    document.execCommand('copy');
                } else {
                    // For general elements (like <p>), create a temporary textarea
                    const tempTextArea = document.createElement('textarea');
                    tempTextArea.value = input.textContent;
                    document.body.appendChild(tempTextArea);
                    tempTextArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempTextArea);
                }
                
                showModal('Success!', 'The data has been copied to your clipboard.', null, null);
            } catch (err) {
                showModal('Error', 'Could not copy text automatically. Please copy the text manually.', null, null);
            }
        }
        
        // --- Generic Fetch with Exponential Backoff ---
        async function fetchWithBackoff(url, options, maxRetries = 3) {
            let retryCount = 0;
            while (retryCount < maxRetries) {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return await response.json();
                } catch (error) {
                    retryCount++;
                    if (retryCount < maxRetries) {
                        const delay = Math.pow(2, retryCount) * 1000;
                        console.warn(`Attempt ${retryCount} failed. Retrying in ${delay}ms...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        throw error;
                    }
                }
            }
        }

        // --- AI Extraction Logic (QR Generator) ---

        async function askAIToGenerateQR() {
            const promptEl = document.getElementById('ai-prompt');
            const dataInputEl = document.getElementById('qr-data');
            const prompt = promptEl.value.trim();
            const btn = document.getElementById('ai-generate-btn');
            const btnText = document.getElementById('ai-btn-text');
            const spinner = document.getElementById('ai-spinner');

            if (!prompt) {
                showModal('Input Required', 'Please type a command, like "QR code for my phone number 555-1234".');
                return;
            }

            // UI State: Loading
            btn.disabled = true;
            btnText.textContent = 'Extracting Data...';
            spinner.classList.remove('hidden');

            const systemPrompt = "You are an AI assistant specialized in extracting target data for QR code generation. The user will provide a command (e.g., 'Make a QR code for my website www.example.com'). Your ONLY task is to extract the complete, exact URL or text string that should be encoded in the QR code. Do not include any conversational text, explanations, or quotes. Output the extracted data/URL only. If no explicit data is found, output the user's query exactly.";

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await fetchWithBackoff(apiUrlBase, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const resultText = result.candidates?.[0]?.content?.parts?.[0]?.text?.trim();

                if (resultText) {
                    dataInputEl.value = resultText;
                    // Generate the QR code, but don't show the distracting AI success modal (pass false)
                    generateAndShowQR(false); 
                    promptEl.value = ''; // Clear prompt
                    showGlobalStatus('AI data extracted and QR code generated successfully!', 4000); 
                } else {
                    showModal('AI Extraction Failed', 'The AI could not extract clear data from your prompt. Try a more direct command.');
                }

            } catch (error) {
                console.error('Gemini API Error:', error);
                showModal('API Error', 'Could not reach the AI service or the request failed after multiple retries.');
            } finally {
                // UI State: Done
                btn.disabled = false;
                btnText.textContent = 'Extract Data & Generate with AI';
                spinner.classList.add('hidden');
            }
        }
        
        // --- QR Code Generator Logic ---

        function generateAndShowQR(isAi = false) {
            const data = document.getElementById('qr-data').value.trim();
            const sizeSelect = document.getElementById('qr-size');
            const size = parseInt(sizeSelect.value, 10);
            const canvas = document.getElementById('qr-canvas');
            const downloadBtn = document.getElementById('qr-download-btn');
            const statusEl = document.getElementById('qr-data-status');
            const manualBtn = document.getElementById('manual-generate-btn');

            // Handle lack of input immediately
            if (!data) {
                if (!isAi) showModal('Input Required', 'Please enter some text or a URL in the "Raw Text or URL to Encode" box before generating.');
                downloadBtn.disabled = true;
                statusEl.classList.add('hidden');
                if(manualBtn) manualBtn.disabled = false;
                return;
            }
            
            if (typeof QRCode === 'undefined') {
                showModal('Error', 'QR Code generation library failed to load.');
                downloadBtn.disabled = true;
                if(manualBtn) manualBtn.disabled = false;
                return;
            }

            // Set buttons to loading/disabled state
            downloadBtn.disabled = true;
            if(manualBtn) manualBtn.disabled = true; 

            // Set canvas size (important for resolution)
            canvas.width = size;
            canvas.height = size;
            statusEl.textContent = `Encoding: ${data.substring(0, 70)}${data.length > 70 ? '...' : ''}`;
            statusEl.classList.remove('hidden');

            try {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear

                QRCode.toCanvas(canvas, data, {
                    errorCorrectionLevel: 'H',
                    margin: 2,
                    width: size,
                    color: { dark: '#000000', light: '#FFFFFF' }
                }, function (error) {
                    if (error) {
                        console.error("QR Code Error:", error);
                        showModal('Generation Error', 'Could not generate QR code. Data might be too large for this resolution or is invalid.');
                        downloadBtn.disabled = true;
                    } else {
                        downloadBtn.disabled = false;
                    }
                    if(manualBtn) manualBtn.disabled = false; // Re-enable manual button
                });

            } catch (e) {
                console.error("QR Generation Failed:", e);
                showModal('Error', 'An unexpected error occurred during QR code generation.');
                downloadBtn.disabled = true;
                if(manualBtn) manualBtn.disabled = false; // Re-enable manual button
            }
        }

        function downloadQR() {
            const canvas = document.getElementById('qr-canvas');
            if (!canvas) return;

            try {
                const link = document.createElement('a');
                link.download = `qrcode-${Date.now()}-${canvas.width}px.png`;
                link.href = canvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (e) {
                showModal('Download Failed', 'Could not initiate the file download.', null, null);
            }
        }

        // --- URL Shortener Logic ---

        async function shortenUrl() {
            const longUrlInput = document.getElementById('long-url');
            const longUrl = longUrlInput.value.trim();
            const outputDiv = document.getElementById('short-url-output');
            const resultInput = document.getElementById('short-url-result');
            const btn = document.getElementById('shorten-btn');

            if (!longUrl || !longUrl.startsWith('http')) {
                showModal('Invalid URL', 'Please enter a valid URL starting with http:// or https://.');
                return;
            }

            outputDiv.classList.add('hidden');
            resultInput.value = 'Shortening...';
            btn.disabled = true;
            showGlobalStatus('Shortening URL...', 0);

            // Using the robust v.gd shortener API
            const apiUrl = `https://v.gd/create.php?format=json&url=${encodeURIComponent(longUrl)}`;

            try {
                // Fetch with backoff handles network errors and retries
                const data = await fetchWithBackoff(apiUrl, { method: 'GET' });

                if (data && data.shorturl) {
                    const shortUrl = data.shorturl;
                    resultInput.value = shortUrl;
                    outputDiv.classList.remove('hidden');
                    showModal('URL Shortened!', `Successfully shortened the URL to: ${shortUrl}`, 'Copy Link', () => copyToClipboard('short-url-result'));
                } else if (data && data.error) {
                    showModal('Shortening Failed', `v.gd Error: ${data.error}`);
                } else {
                    showModal('Shortening Failed', 'Could not shorten URL. The service might be temporarily unavailable or the URL is invalid.');
                }
            } catch (error) {
                console.error('Shortening error:', error);
                showModal('Network Error', 'The URL shortening service could not be reached after multiple retries.');
            } finally {
                hideGlobalStatus();
                btn.disabled = false;
            }
        }


        // --- Tab Content Templates (Only Generator and Shortener) ---

        const tabContent = {
            'generator': `
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800">Generate QR Code</h2>

                    <div class="p-4 bg-indigo-50 rounded-xl border border-indigo-200">
                        <label for="ai-prompt" class="block text-sm font-bold text-indigo-700 mb-1">ü§ñ AI Prompt (Gemini API):</label>
                        <textarea id="ai-prompt" rows="2" class="w-full p-3 border border-indigo-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm" placeholder="e.g., Generate a QR code for my business card: John Doe, 555-1234, john@email.com"></textarea>
                        <button id="ai-generate-btn" onclick="askAIToGenerateQR()" class="w-full mt-2 px-4 py-2 bg-indigo-500 text-white font-bold rounded-lg hover:bg-indigo-600 transition shadow-lg flex items-center justify-center disabled:opacity-50">
                            <span id="ai-btn-text">Extract Data & Generate with AI</span>
                            <div id="ai-spinner" class="loading-spinner hidden ml-3"></div>
                        </button>
                    </div>

                    <div class="mt-4">
                        <label for="qr-data" class="block text-sm font-medium text-gray-700 mb-1">Raw Text or URL to Encode (Manual)</label>
                        <textarea id="qr-data" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm" placeholder="Enter text, a link, or any data..."></textarea>
                    </div>

                    <button id="manual-generate-btn" onclick="generateAndShowQR(false)" class="w-full px-4 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition shadow-lg">
                        Manual Generate QR Code
                    </button>

                    <div id="qr-output" class="mt-6 flex flex-col items-center p-4 bg-gray-50 rounded-xl border border-gray-200 shadow-inner">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2 w-full text-center">QR Code Preview</h3>
                        <p id="qr-data-status" class="text-sm text-gray-500 mb-3 hidden"></p>
                        
                        <canvas id="qr-canvas" width="256" height="256" class="p-2 bg-white rounded-lg shadow-md"></canvas>
                        
                        <div id="qr-download-container" class="mt-4 text-center w-full max-w-xs md:max-w-md">
                            <p class="text-sm text-gray-600 mb-2">Select resolution and download PNG:</p>
                            <div class="flex items-stretch space-x-2">
                                <select id="qr-size" class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition shadow-sm">
                                    <option value="128">128x128 (Small)</option>
                                    <option value="256" selected>256x256 (Medium)</option>
                                    <option value="512">512x512 (Large)</option>
                                    <option value="1024">1024x1024 (High Res)</option>
                                </select>
                                <button id="qr-download-btn" onclick="downloadQR()" class="px-6 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition shadow-lg flex-shrink-0 disabled:opacity-50" disabled>
                                    Download
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `,
            'shortener': `
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800">Shorten Your URL</h2>
                    <p class="text-sm text-gray-500">Uses a free public shortener service (v.gd).</p>
                    
                    <div>
                        <label for="long-url" class="block text-sm font-medium text-gray-700 mb-1">Enter Long URL</label>
                        <input type="url" id="long-url" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition shadow-sm" placeholder="e.g., https://very-long-url.com/path/to/page">
                    </div>
                    
                    <button id="shorten-btn" onclick="shortenUrl()" class="w-full px-4 py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition shadow-lg">
                        Shorten URL
                    </button>
                    
                    <div id="short-url-output" class="hidden mt-4 p-4 bg-green-50 border border-green-200 rounded-xl shadow-inner space-y-3">
                        <p class="text-green-800 font-medium">Your Shortened URL:</p>
                        <div class="flex items-center space-x-3">
                            <input type="text" id="short-url-result" class="flex-grow p-2 border border-green-300 rounded-lg bg-white font-mono text-sm" readonly>
                            <button onclick="copyToClipboard('short-url-result')" class="px-3 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600 transition">
                                Copy
                            </button>
                        </div>
                    </div>
                </div>
            `
        };

        // --- Main Tab Switching Function ---
        
        function switchTab(tabName) {
            // 1. Update button styles
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.remove('bg-indigo-600', 'text-white', 'hover:bg-indigo-700', 'shadow-md');
                btn.classList.add('bg-gray-100', 'text-gray-700', 'hover:bg-gray-200');

                if (btn.getAttribute('data-tab') === tabName) {
                    btn.classList.add('active');
                    btn.classList.add('bg-indigo-600', 'text-white', 'hover:bg-indigo-700', 'shadow-md');
                    btn.classList.remove('bg-gray-100', 'text-gray-700', 'hover:bg-gray-200');
                }
            });

            // 2. Inject new content
            document.getElementById('content-container').innerHTML = tabContent[tabName];
            currentTab = tabName;

            // 3. Initialization based on the new tab
            if (tabName === 'generator') {
                const aiBtn = document.getElementById('ai-generate-btn');
                if (aiBtn) aiBtn.disabled = false; // Enable AI button

                document.getElementById('qr-size').addEventListener('change', () => {
                     if (document.getElementById('qr-data').value.trim()) {
                        generateAndShowQR(false); 
                    }
                });
                // Initial generation to show a default QR code
                document.getElementById('qr-data').value = 'https://www.google.com';
                setTimeout(() => {
                    const dataInput = document.getElementById('qr-data');
                    if (dataInput && dataInput.value.trim()) {
                        generateAndShowQR(false);
                    }
                }, 100); 
            }
        }

        // --- Initialization ---

        document.addEventListener('DOMContentLoaded', () => {
            // Set up tab switching listeners
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', (e) => {
                    const tab = e.target.getAttribute('data-tab');
                    switchTab(tab);
                });
            });
            
            // Initialize to the default tab
            switchTab(currentTab);
        });
    </script>
</body>
</html>
